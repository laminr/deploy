{% extends '::base.html.twig' %}

{% block pageId %}
  id="deploy-main" ng-app="deployApp" ng-controller="DeployCtrl"
{% endblock %}

{% block stylesheets %}
    <link href="{{ asset('css/deploy.css') }}" rel="stylesheet" media="screen" />
    <link href='http://fonts.googleapis.com/css?family=Pacifico' rel='stylesheet' type='text/css'>
    {{ parent() }}
{% endblock %}

{% block body %}
<div class="container">
    
    <!-- LISTE BRANCHE -->
    <div class="row">

        <div class="row">
            <div class="col-xs-12">
                {{ include('RsvDeployBundle:Default:navbar.html.twig') }}
            </div>
        </div>

        <div class="row">

            <div class="col-lg-3 col-md-6">
                <div class="col-sm-12">
                    <h3>{% trans %}rsv3.deploy.project{% endtrans %}</h3>
                    <div class="list-group">
                        <a href="#" class="list-group-item"
                           ng-repeat="project in projects"
                           ng-click="select(project.id)"
                           ng-class="{ active: selected == project.id }"
                                >
                                [[project.name]]
                        </a>
                    </div>
                </div>
            </div>
            <!-- COLONE 2 -->
            <div class="col-lg-4 col-md-6">
                <div class="row" id="qualif" ng-show="server.qualif.show">
                    {{ include('RsvDeployBundle:Default:update.html.twig' , {'currentServer': 'currentQualif', 'currentActive' : 'activ-qualif', 'currentUpdate' : 'update-qualif'}) }}
                </div>
                <div class="row" id="preprod" ng-show="server.preprod.show">
                    {{ include('RsvDeployBundle:Default:update.html.twig' , {'currentServer': 'currentPreProd', 'currentActive' : 'activ-preprod', 'currentUpdate' : 'update-preprod'}) }}
                </div>
                <!-- PROD -->
                <div class="row" id="prod" ng-show="server.prod.show">
                    {{ include('RsvDeployBundle:Default:prod.html.twig') }}
                </div>

            </div> <!-- fin colonne 2 -->

            <div class="col-lg-5 hidden-md">
                <code class="col-xs-12" id="bash-return"></code>
            </div>
        </div>

	</div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
    <script src="{{ asset('js/controllers.js') }}"></script>
    <script type="text/javascript">
        {#
        var deployParams = {
            project : "{{current}}",
            urls: {{urls} "{{name}}" : "{value}",{/urls}},
            labels: {{labels} "{{name}}" : "{{value}}",{/labels}},
            envs: {{envs} "{{name}}" : { "name" : "{{name}}", "id" : "{{value}}"},{/envs}},
            type: { "branch" : "branch", "tag" : "tag" }
        };
         #}

        var projects = [ {% for project in data.projects %}{ "id" : {{ project.id }},  "name" : "{{ project.name }}" }, {% endfor %} ];
    </script>
{% endblock %}